(function(){function u(n,t,i,r){n/=255;t/=255;i/=255;r*=100;let h=Math.min(n,t,i),o=Math.max(n,t,i),u=o-h,f=0,s=0,e=0;return f=u==0?0:o==n?(t-i)/u%6:o==t?(i-n)/u+2:(n-t)/u+4,f=Math.round(f*60),f<0&&(f+=360),e=(o+h)/2,s=u==0?0:u/(1-Math.abs(2*e-1)),s=+(s*100).toFixed(1),e=+(e*100).toFixed(1),[f,s+"%",e+"%",r+"%"]}class r{constructor(n,t,i){return this.element=document.createElement("span"),this.displayText=n,this.classListOpts=t,this.styleOpts=i,this.build(),this.html=this.element,this.html}build(){let n=this.element;/<\/?[a-z][\s\S]*>/i.test(this.displayText)?n.innerHTML=this.displayText:n.innerText=this.displayText;this.addClasses();this.setCss()}addClasses(n){if(this.classListOpts||n)this.classListOpts&&(n=this.classListOpts);else return;var t=typeof n=="string"?n.split(" "):n;t.forEach(n=>this.element.classList.add(n))}setCss(n){var u,i,t,f,e;if(this.styleOpts||n)this.styleOpts&&(n=this.styleOpts);else return;let r="";if(n instanceof Array)for(u of n)r+=`${u};`;else if(n instanceof Object)for([i,t]of Object.entries(n))isNaN(parseFloat(String(t)))||i=="z-index"||i=="opacity"||(typeof t=="string"?(f=["%","vw","vh","em","px","ex","ch","rem","lh","vmin","vmax","cm","mm","Q","in","pc","pt","deg","s"],e=f.filter(n=>String(t).indexOf(n)>-1),e.length==0&&(t=parseFloat(t)+"px")):t=parseFloat(String(t))+"px"),r+=`${i}: ${t};`;this.element.style.cssText=r}}class n{constructor(n,t){return this.element=document.createElement("div"),this.html=this.element,this.build(n,t),this.html}build(n,t){let i=this;n&&i.addClasses(n);t&&i.setCss(t)}addClasses(n){var t=typeof n=="string"?n.split(" "):n;t.forEach(n=>this.element.classList.add(n))}setCss(n){var u,i,t,f,e;if(n){let r="";if(n instanceof Array)for(u of n)r+=`${u};`;else if(n instanceof Object)for([i,t]of Object.entries(n))isNaN(parseFloat(t))||i=="z-index"||i=="opacity"||(typeof t=="string"?(f=["%","vw","vh","em","px","ex","ch","rem","lh","vmin","vmax","cm","mm","Q","in","pc","pt","deg","s"],e=f.filter(n=>t.indexOf(n)>-1),e.length==0&&(t=parseFloat(t)+"px")):t=parseFloat(t)+"px"),r+=`${i}: ${t};`;this.element.style.cssText=r}}highlight(){let n=0;var t=setInterval(()=>{n>=3&&(clearInterval(t),this.unhighlight()),n+=.5,this.element.style.border=`solid rgba(255,0,0,1) ${n}px`},100)}unhighlight(){var n=3,t=setInterval(()=>{n<=0&&(clearInterval(t),this.element.style.border="",this.element.style.length==0&&this.element.removeAttribute("style")),n-=.5,this.element.style.border=`solid rgba(255,0,0,1) ${n}px`},100)}parseScripts(n){var t,r,i,u,f;n||(n=`Couldn't process the scripts when loading the content of the the div ${this.element.className}`);let e=this.element.getElementsByTagName("script");if(e.length>0)try{for(t of e)t.src!=""?t instanceof HTMLScriptElement&&(r=t.src.substring(t.src.lastIndexOf("/")+1),document.querySelector(`[data-js-loaded="${r}"]`)?eval(t.innerText):(i=document.createElement("script"),i.src=t.src,i.dataset.jsLoaded=r,i.innerText=t.innerText,document.body.append(i),u=0,f=setInterval(()=>{try{eval(i.innerText);clearInterval(f)}catch(n){u++;u>5&&clearInterval(f)}},500))):eval(t.innerHTML)}catch(o){console.warn(n)}}fadeOut(n="normal"){var t,i;if(this.element.dataset.display=this.element.style.display,this.element.dataset.hasOpacity=String(this.element.style.opacity!=""),t=75,n)switch(n){case"slow":t=75;break;case"normal":default:t=50;break;case"fast":t=25}i=setInterval(()=>{this.element.style.opacity||(this.element.style.opacity="1"),parseInt(this.element.style.opacity)>0?this.element.style.opacity=String(parseFloat(this.element.style.opacity)-.1):(clearInterval(i),this.element.style.display="none")},t)}}class t{constructor(n,t){if(n instanceof HTMLInputElement==!1)throw"Input element required.";if(n.type!="file")throw"Uploader must be a file type input field.";this.inputRef=n;this.settings=t;this.filesForUpload=new DataTransfer;this.fileTypes=["doc","docx","xls","xlsx","csv","pdf","pptx"];this.imageTypes=["gif","png","jpeg","jpg"];this.html=undefined;this.defaults={displayText:"Click here or drag and drop a file to upload it here",allowMultiple:!1,allowedFileTypes:["gif","png","jpeg","jpg"],clickToUpload:!0,initClass:"da-applied",imagesOnly:!0,maxFiles:5,resetOnDrop:!1};this.build()}addError(t){t||(t="There has been an error processing this file for upload.");let i=new n("uploadError");i.innerText=t;this.html.querySelector(".drop-zone-inner-border").append(i)}addIcons(){let t=this.html.querySelector(".drop-zone-inner-border");const n="Scripts/DropZone/icons/";t.querySelectorAll("figure").forEach(n=>n.remove());let i=this.filesForUpload.files;Array.from(i).forEach(i=>{var r,f;let u=document.createElement("figure"),o=i.name.substr(i.name.lastIndexOf(".")+1);r=new Image(75,75);u.append(r);u.addEventListener("contextmenu",()=>{this.handleRightClick(i,u)});switch(o){case"pdf":r.src=n+"pdf-512.png";break;case"pptx":r.src=n+"pptx-512.png";break;case"doc":case"docx":r.src=n+"Word-512.png";break;case"xls":case"xlsx":case"csv":r.src=n+"Excel-512.png";break;case"txt":r.src=n+"notepad.png";break;default:f=new FileReader;f.onload=function(){r.src=f.result};f.readAsDataURL(i)}let e=document.createElement("figcaption");e.innerText=i.name;u.append(e);t.append(u)})}init(){var t,i,r;this.setCss();this.inputRef.hasAttribute("disabled");this.inputRef.removeAttribute("disabled");this.settings||(this.settings=this.defaults);for([t,i]of Object.entries(this.defaults))this.settings[t]||(this.settings[t]=i);this.settings.allowMultiple=this.inputRef.hasAttribute("multiple");this.settings.allowMultiple||(this.settings.resetOnDrop=!0,this.settings.maxFiles=1);this.inputRef.hasAttribute("accept")?(this.settings.allowedFileTypes==this.defaults.allowedFileTypes&&(this.settings.allowedFileTypes=[]),r=this.inputRef.accept.split(","),this.settings.allowedFileTypes=this.settings.allowedFileTypes.concat(r.filter(n=>n.length<=5)),this.settings.allowedFileTypes=[...new Set(this.settings.allowedFileTypes)]):this.settings.imagesOnly||JSON.stringify(this.settings.allowedFileTypes)!=JSON.stringify(this.imageTypes)||this.fileTypes.forEach(n=>this.settings.allowedFileTypes.push(n));this.html.classList.add(this.settings.initClass);window.addEventListener("drop",function(n){n.preventDefault()});window.addEventListener("dragover",function(n){n.preventDefault()});let n=this;["dragenter","dragover","dragleave","drop"].forEach(t=>{this.html.addEventListener(t,function(i){i.preventDefault();i.stopPropagation();switch(t){case"dragenter":case"dragover":n.highlight();break;case"dragleave":n.unhighlight();break;case"drop":n.unhighlight();n.dropHandler(t)}})});this.settings.clickToUpload&&this.clickEvents()}build(){this.html=new n("drop-zone");let u=new n("drop-zone-inner-border");this.html.append(u);this.init();let t=this.inputRef;t.parentElement.insertBefore(this.html,t.parentElement.children[0]);t.style.display="none";let i=t.parentElement.querySelector("label");i&&(i.style.display="none",this.settings.displayText==this.defaults.displayText&&(this.settings.displayText=`${this.settings.clickToUpload?"Click here or drag":"Drag"} and drop file${this.settings.allowMultiple?"s":""} here for upload`));let r=new n("displayText");r.innerText=this.settings.displayText;this.html.querySelector(".drop-zone-inner-border").append(r)}clickEvents(){let n=this.html.querySelector(".drop-zone-inner-border");var t=this;n.addEventListener("click",function(n){n.preventDefault();n.stopPropagation();t.inputRef.click()});n.addEventListener("contextmenu",()=>{this.handleRightClick()});this.inputRef.addEventListener("click",function(n){n.stopPropagation()});this.inputRef.addEventListener("change",()=>{this.handleClickUpload(event)})}handleRightClick(t,i){event.preventDefault();event.stopPropagation();let u=new n("drop-zone-contextMenu",{left:`${event.clientX-10}px`,top:`${event.clientY-10}px`});if(t){let n=new r("Remove");n.addEventListener("click",()=>{event.stopPropagation(),Array.from(this.filesForUpload.files).forEach((n,i)=>{n.name==t.name&&(this.filesForUpload.items.remove(i),this.filesForUpload.items.length==0&&(this.html.style.height="100px"))}),this.inputRef.files=this.filesForUpload.files,this.filesForUpload.length==0&&this.inputRef.removeAttribute("value"),i.remove(),u.remove()});u.append(n)}i||(i=event.target);let e=new r("Clear All");e.addEventListener("click",()=>{event.stopPropagation(),this.filesForUpload.clearData(),this.inputRef.files=(new DataTransfer).files,this.inputRef.removeAttribute("value"),i.parentElement.querySelectorAll("figure").forEach(n=>n.remove()),this.html.style.height="100px",u.remove()});u.append(e);i.parentElement.insertBefore(u,i.parentElement.children[0]);let f=0;u.addEventListener("mouseleave",()=>{f=setTimeout(()=>{u.remove()},250)});u.addEventListener("mouseEnter",()=>{f!=0&&(clearTimeout(f),f=0)})}handleClickUpload(n){event.preventDefault();event.stopPropagation();let t=n.target,i=t.files;this.handleFiles(i)}dropHandler(){let n=event.dataTransfer.files;if(!this.settings.allowMultiple&&n.length>this.settings.maxFiles)return this.addError(`Cannot upload this many files. Only ${this.settings.maxFiles} files are allowed to be uploaded at a time.`),!1;this.reset(!0);this.inputRef.files=n;const t=new Event("change");this.inputRef.dispatchEvent(t)}fileTypeCheck(n){let t=n.name.toLowerCase().split(".");t=t[t.length-1];let i=!0;return this.settings.allowedFileTypes.indexOf(`.${t}`)>=0||this.settings.allowedFileTypes.indexOf(t)>=0?i:!i}checkFile(n){var t=Array.from(this.filesForUpload.files);t.forEach((t,i)=>{t.name==n.name&&this.filesForUpload.items.remove(i)});this.filesForUpload.items.add(n)}handleFiles(n){if(this.reset(!0),this.settings.allowMultiple){if(n.length>this.settings.maxFiles||this.filesForUpload.files.length+n.length>this.settings.maxFiles)return this.addError(`Cannot upload this many files. Only ${this.settings.maxFiles} files are allowed to be uploaded at a time.`),!1;Array.from(n).forEach(n=>{this.fileTypeCheck(n)?this.checkFile(n):this.addError(`${n.name} is not an allowed file type. Only the following file type(s) are allowed: ${this.settings.allowedFileTypes.toString()}`)})}else if(this.settings.allowMultiple==!1&&n.length==1)this.fileTypeCheck(n[0])?this.checkFile(n[0]):this.addError(`${n[i].name} is not an allowed file type. Only the following file type(s) are allowed: ${this.settings.allowedFileTypes.toString()}`);else{this.addError("Only one file allowed to be uploaded");return}this.addIcons();this.inputRef.files=this.filesForUpload.files}highlight(){this.html.classList.add("highlight")}reset(n=false){this.filesForUpload instanceof DataTransfer==!1&&(this.filesForUpload=new DataTransfer);let t=this.html.querySelectorAll(".uploadError");if(t&&t.forEach(n=>n.remove()),this.html.style.height="100%",n&&this.settings.resetOnDrop||!n){let n=this.html.querySelectorAll("figure");n&&n.forEach(n=>n.remove());this.filesForUpload.clearData();this.inputRef.files=this.filesForUpload.files}}setCss(){var u,n,t;let i=document.querySelector("head").querySelector("#dropAreaCss");if(!i){i=document.createElement("style");document.querySelector("head").append(i);i.id="dropAreaCss";i.type="text/css";let r=this.inputRef;u=getComputedStyle(r).backgroundColor.replace(/\s+/g,"").match(/(rgba\(0,0,0,0\))|(rgb\(0,0,0\))/g);try{while(u)r=r.parentElement,u=getComputedStyle(r).backgroundColor.replace(/\s+/g,"").match(/(rgba\(0,0,0,0\))|(rgb\(0,0,0\))/g)}catch(e){u=!1}n=getComputedStyle(r).backgroundColor;t=getComputedStyle(r).color;(!n||u)&&(n="rgba(220,220,220,1)");(!t||u)&&(t="rgba(33,33,33,1)");let f=`.drop-zone{width:100%;height:100px; background-color:${this.whiteShift(n,10,.8)};padding:5px; min-width:200px; min-height:100px; padding:5px}
.drop-zone.highlight{background-color:${this.whiteShift(n,90,1)};color:${this.whiteShift(t,-10,1)};}
.drop-zone .drop-zone-inner-border{border:dashed ${this.whiteShift(n,30)} 2px;height:100%; display:flex;align-items:center; flex-flow:wrap; gap:15px;}
.drop-zone .drop-zone-inner-border:hover{cursor:pointer;background-color:${this.whiteShift(n,10)};color:${this.whiteShift(t,-10)};}
.drop-zone .drop-zone-inner-border figure{max-width:250px; word-break:break-all;padding:5px;box-shadow:0 0 5px rgba(0,0,0,.5);margin:15px;}
.drop-zone .displayText{ width:100%;color:${this.whiteShift(t,-10,.9)}}
.drop-zone .uploadError{color:red; width:100%;}
.drop-zone .drop-zone-contextMenu{z-index: 999999999;background-color:${this.whiteShift(n,10,1)};color:${this.whiteShift(t,-10,1)};position:fixed; border-radius:15px; padding:10px; border-color:${this.whiteShift(t,-90,1)}; border:solid 1px;}
.drop-zone .drop-zone-contextMenu > span{display:block; width:100%; padding-left:10px; padding-right:10px; border-radius:5px;}
.drop-zone .drop-zone-contextMenu > span:hover{background-color:${this.whiteShift(n,45,1)};color:${this.whiteShift(t,-5,1)};cursor:pointer;}`;i.append(document.createTextNode(f))}}unhighlight(){this.html.classList.remove("highlight")}whiteShift(n,t=20){if(n){if(t==100)return"rgb(255,255,255)";let[f=0,e=0,o=0,s=1]=n.replace(/(rgb\()|((rgba\())|(\))|\s+/g,"").split(",").map(n=>+n),i=u(f,e,o,s);var r=parseInt(i[2])+t*parseInt(i[2])/100;i[2]=r<100?`${r}%`:"100%";let h=`${n.match(/(rgb\()|((rgba\())/)[0]}${i.join(",")})`;return h.replace(/rgb|rgba/g,"hsla")}}}window.DropZone=function(n,i){return new t(n,i)};HTMLInputElement.prototype.dropZonify=function(n){return new t(this,n)};HTMLFormElement.prototype.dropZonify=function(n){this.querySelectorAll('input[type="file"]').forEach(i=>new t(i,n))}})();